" vim:ft=vim

Execute(Function WindowCount):
  function! WindowCount(winid) abort
    let count = 1
    for i in range(1, winnr('$'))
      if !empty(getwininfo(win_getid(i)))
        let count += 1
      endif
    endfor
    return count
  endfunction

Execute(FloatermNew floaterm ../LICENSE):
  FloatermNew floaterm ../LICENSE
  sleep 100m
  Assert expand('%:t') == 'LICENSE'
  " floating window is closed
  for winnr in range(1, winnr('$'))
    Assert empty(nvim_win_get_config(win_getid())['relative'])
  endfor

Execute(FloatermNew cat ../LICENSE | floaterm):
  FloatermNew cat ../LICENSE | floaterm
  sleep 100m
  " floating window is closed
  for winnr in range(1, winnr('$'))
    Assert empty(nvim_win_get_config(win_getid())['relative'])
  endfor

Execute (Exit):
  stopinsert
  FloatermKill!
  sleep 100m
